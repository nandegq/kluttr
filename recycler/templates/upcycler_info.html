{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h2 class="text-center mb-4">My Profile</h2>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h5 class="card-title">{{ request.user.username }}</h5>
      <p class="card-text">
        <strong>Company:</strong> {{ request.user.collector.company_name }}<br>
        <strong>Contact Number:</strong> {{ request.user.collector.contact_number }}<br>
        <strong>Preferred Waste:</strong> {{ request.user.collector.preferred_waste }}<br>
        <strong>Email:</strong> {{ request.user.email }}
      </p>
    </div>
  </div>

  <h4 class="mb-3">Pickup History</h4>

  {% if pickups %}
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>Customer</th>
          <th>Waste Type</th>
          <th>Status</th>
          <th>Scheduled Date</th>
        </tr>
      </thead>
      <tbody>
        {% for pickup in pickups %}
        <tr>
          <td>{{ pickup.id }}</td>
          <td>{{ pickup.customer.user.username }}</td>
          <td>{{ pickup.waste_type }}</td>
          <td>
            {% if pickup.customer_pickup_completed == 'Completed' %}
            <span class="badge bg-success">Completed</span>
            {% elif pickup.customer_pickup_completed == 'Assigned' %}
            <span class="badge bg-primary">Assigned</span>
            {% else %}
            <span class="badge bg-warning text-dark">{{ pickup.status }}</span>
            {% endif %}
          </td>
          <td>{{ pickup.scheduled_date|date:"M d, Y" }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-muted">No pickups found yet.</p>
  {% endif %}
</div>
{% endblock %}