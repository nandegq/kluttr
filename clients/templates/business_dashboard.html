{% extends 'base.html' %}

{% block title %}
Business Dashboard | Kluttr
{% endblock %}

{% block content %}
<div class="text-center space-y-8">
    <h1 class="text-3xl font-bold text-gray-800">Welcome, {{ user.username }} ðŸ‘‹</h1>
    <p class="text-gray-600 text-lg">
        Manage your waste pickups, subscriptions, and track progress all from one place.
    </p>

    <!-- Show current plan or On-Demand pickup -->
    {% if user.client.selected_plan %}
    <p class="text-gray-700 text-lg font-medium mt-2">
        Current Plan: <strong>{{ user.client.selected_plan.name }}</strong> -
        {{ user.client.selected_plan.pickups_per_month }} pickup{% if user.client.selected_plan.pickups_per_month > 1
        %}s{% endif %} per month
    </p>
    {% elif user.client.material_type %}
    <p class="text-gray-700 text-lg font-medium mt-2">
        Current On-Demand Pickup: <strong>{{ user.client.material_type|capfirst }}</strong>
    </p>
    {% else %}
    <p class="text-gray-700 text-lg font-medium mt-2">
        You currently have no active plan or On-Demand pickup.
    </p>
    {% endif %}

    <!-- Quick Actions -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mt-10">

        <!-- Plan Selection -->
        <div class="glass p-6 rounded-2xl shadow-md hover:shadow-lg transition">
            <h3 class="text-xl font-semibold mb-2 text-gray-800">Manage your plan</h3>
            <p class="text-gray-600 mb-4">View or change your plan.</p>
            <a href="{% url 'clients:manage_plan' %}"
                class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                View Plans
            </a>
        </div>

        <!-- Schedule Pickups -->
        <div class="glass p-6 rounded-2xl shadow-md hover:shadow-lg transition">
            <h3 class="text-xl font-semibold mb-2 text-gray-800">Schedule Pickups</h3>
            <p class="text-gray-600 mb-4">
                {% if user.client.selected_plan %}
                Once subscribed, you can schedule your pickups for the month.
                {% elif user.client.material_type %}
                You can schedule your On-Demand pickup below.
                {% else %}
                You need a plan or On-Demand pickup to schedule.
                {% endif %}
            </p>
            {% if user.client.selected_plan or user.client.material_type %}
            <a href="{% url 'clients:schedule' %}"
                class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                Schedule Now
            </a>
            {% else %}
            <button class="bg-blue-300 text-white px-4 py-2 rounded-lg cursor-not-allowed" disabled>
                Schedule Now
            </button>
            {% endif %}
        </div>

        <!-- View Reports -->
        <div class="glass p-6 rounded-2xl shadow-md hover:shadow-lg transition">
            <h3 class="text-xl font-semibold mb-2 text-gray-800">View Analytics</h3>
            <p class="text-gray-600 mb-4">Track your impact and progress.</p>
            {% if user.client.selected_plan or user.client.material_type %}
            <a href="{% url 'analytics:client_dashboard' %}"
                class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                View Now
            </a>
            {% else %}
            <button class="bg-blue-300 text-white px-4 py-2 rounded-lg cursor-not-allowed" disabled>
                View Analytics
            </button>
            {% endif %}
        </div>

    </div>
</div>
{% endblock %}